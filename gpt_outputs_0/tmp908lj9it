<?xml version="1.0" encoding="UTF-8"?>
<missionPlanSchema:Mission xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                           xmlns:xi="http://www.w3.org/2001/XInclude"
                           xmlns:xs="http://www.w3.org/2001/XMLSchema"
                           xmlns:missionPlanSchema="http://example.com/missionPlanSchema">
    <Identification>
        <Name>Robotic Fruit Collection Mission</Name>
        <Description>Visit all the trees on the farm, prioritize points sampled longer ago.</Description>
        <Author>Robot Planner</Author>
        <Version>1.0</Version>
    </Identification>
    <Parameters>
        <TimeResolution>60s</TimeResolution>
    </Parameters>

    <!-- Loop through GeoJSON features to create tasks -->
    <xsl:for-each select="/FeatureCollection/Feature">
        <missionPlanSchema:CompositeTaskInformation xsi:type="SequentialTask">
            <!-- Original Question -->
            <missionPlanSchema:TaskDescription><xsl:value-of select="properties/description"/></missionPlanSchema:TaskDescription>

            <Position>
                <!-- Extract GPS coordinates from the GeoJSON feature -->
                <missionPlanSchema:Coordinates>
                    <Latitude><xsl:value-of select="geometry/coordinates/2"/></Latitude>
                    <Longitude><xsl:value-of select="geometry/coordinates/1"/></Longitude>
                </missionPlanSchema:Coordinates>
            </Position>

            <!-- Drive to the location -->
            <missionPlanSchema:CompositeTaskInformation xsi:type="SequentialTask">
                <TaskName>DriveToLocation</TaskName>
                <Position>
                    <missionPlanSchema:Coordinates>
                        <Latitude><xsl:value-of select="geometry/coordinates/2"/></Latitude>
                        <Longitude><xsl:value-of select="geometry/coordinates/1"/></Longitude>
                    </missionPlanSchema:Coordinates>
                </Position>
            </missionPlanSchema:CompositeTaskInformation>

            <!-- Do the required action based on properties -->
            <missionPlanSchema:CompositeTaskInformation xsi:type="SequentialTask">
                <TaskName><xsl:value-of select="properties/name"/></TaskName>
                <!-- Multiple tasks at the same location should be separated by "Parallel" TaskTypes -->
                <missionPlanSchema:TaskType>Sequential</missionPlanSchema:TaskType>
                <missionPlanSchema:Outcome><xsl:value-of select="properties/outcome"/></missionPlanSchema:Outcome>
            </missionPlanSchema:CompositeTaskInformation>
        </missionPlanSchema:CompositeTaskInformation>
    </xsl:for-each>

    <!-- Drive to and do an action at home location (if needed) -->
    <xsl:variable name="home_location">
        <Feature><!-- GeoJSON home location data should be inserted here --></Feature>
    </xsl:variable>

    <xsl:if test="$home_location">
        <!-- Drive to the home location -->
        <missionPlanSchema:CompositeTaskInformation xsi:type="SequentialTask">
            <TaskName>DriveToLocation</TaskName>
            <Position>
                <!-- Extract GPS coordinates from the home location -->
                <missionPlanSchema:Coordinates>
                    <Latitude><xsl:value-of select="$home_location/Feature/geometry/coordinates/2"/></Latitude>
                    <Longitude><xsl:value-of select="$home_location/Feature/geometry/coordinates/1"/></Longitude>
                </missionPlanSchema:Coordinates>
            </Position>
        </missionPlanSchema:CompositeTaskInformation>

        <!-- Do the required action at home location (if needed) -->
        <missionPlanSchema:CompositeTaskInformation xsi:type="SequentialTask">
            <TaskName><xsl:value-of select="$home_location/Feature/properties/name"/></TaskName>
            <missionPlanSchema:TaskType>Sequential</missionPlanSchema:TaskType>
            <missionPlanSchema:Outcome><xsl:value-of select="$home_location/Feature/properties/outcome"/></missionPlanSchema:Outcome>
        </missionPlanSchema:CompositeTaskInformation>
    </xsl:if>

    <!-- Comment out the estimated total Haversine distance traveled from start to end in the Outcome -->
    <Outcome>Estimated total Haversine distance traveled from start to end.</Outcome>
</missionPlanSchema:Mission>
